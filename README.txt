GEOSIMCO Analyzer- Geometric similarity based software to analyze three-dimensional fluorescence patterns 

A MATLAB based script to process batches of CSLM images, generating statistically treatable data about spatial distribution of fluorescence within the analyzed set of colonies


A) SUMMARY

This program is designed to automatically navigate through a folder tree to automatically load  
stored *.lif files in them and open all the images contained.    
For every image the software detect all the colonies with circular symmetry, retrieve their fluorescent    
profile using two representations as representative of the whole colony: XY sum projection and the XZ plane (Y=0)

After retrieving the XY and XZ profiles of every detected colony, they are spatially mapped to a normalized domain     
X[-1 1], Y[-1,1], Z[0,1] using the Radius and Height of every colony. Then intensity values in a fixed grid of reference   
is generated by a cubic interpolation using a Delaunay triangulation onto the given set of points for every colony. 

The interpolated data is stored into three-dimensional matrices to finally generate statistic in every point of the
reference grid. The program finally plots this data with three types of figures:
Raw fluorescence, normalized heatmaps and Coefficient of variation    


B) ATTACHED FILES

The provided package contains the following files:

1- Main MATLAB script (GEOSIMCO_v1.m)

2- Auxiliary functions of GEOSIMCO script (norm_surface_colony_v3.m , removepoints_v1.m)

Due to storage limitation, original folders containing *.lif files of two different biological replica containing confocal images of colonies (used as examples for testing the program (P35_4A, P35_4B)) are not uploaded. They may be found in the next link:

https://fairdomhub.org/data_files/2946?version=1

Check that both file folders (P35_4A, P35_4B) are located in the same folder as the rest of the scripts for a proper working


C) TEST THE SCRIPT

1- Download the bioformats package for MATLAB (https://downloads.openmicroscopy.org/bio-formats/5.3.4/). Unzip and copy the folder into desired working folder.

2- Unzip GEOSIMCO.zip file into desired working folder

3- Open MATLAB and browse working directory to desired working folder

4- Open GEOSIMCO_v1.m with script editor and run the program


D) MODIFY THE SCRIPT

The code is commented by small blocks where different operations are applied. Nevertheless the provided script can be used, copied and modified under the MIT license requirements. Feel free to implement any change that could make it more useful or clear. 


E) ADJUSTING THRESHOLDS

Threhold values used to perform labeling or selection operations are marked in the script with some tags described here below. Values can be changed at will to improve the
operation of the script.

**0** ==> XY projection type. It is selected SUM projection by default. However a different criteria can be applied

**1** ==> thres_ratio. Threshold value chosen to generate XY masking (which delimites the colonies from the background)

**2** ==> radius_threshold. Discriminate by radius which detected objects are real colonies.

**3** ==> axis_ratio_threshold. Define the maximum allowable drift in radius between major and minor axis detected for every labeled object, allowing to discard not symmetric bodies
such as merged colonies


F) NOTES

The script is written to work assuming that folders containing the images are sorted first by dir command in MATLAB (i.e. see line 110 in GEOSIMCO_v1.m). When using your own folders, be sure that the name of your folders are listed first.


